#!/usr/bin/env Rscript
# author: Maxime Benoit-Gagne - Takuvik - Canada.
# date of creation: October 19, 2015.
#
# Usage:
# ./do_ncfiles_ncdf.R
#
# Generate NetCDF files.
#============================================================================
# Library.
library(ncdf4)

#============================================================================
# Constants and parameters.

# Inputs for pixels at rows 2 and 48 of the prototype for Mathieu in
# /Volumes/Disk6TB/Takuvik/Teledetection/Couleur/Other/Mathieu/Malina/Fig8/IN/IN20140815/PPARR5_Mathieu_BG_RRS_Profile_1_1000.txt.

array2d_ipix_iband_Rrs_data <- c(
  c(0.008642, 0.008084, 0.006332, 0.004698, 0.003626, 0.002036),
  c(0.000064, 0.0008, 0.001718, 0.003318, 0.00399, 0.001152),
  c(0.000064, 0.0008, 0.001718, 0.003318, 0.00399, 0.001152)
)
array2d_ipix_iband_Rrs <- matrix(
  data = array2d_ipix_iband_Rrs_data,
  nrow = 3,
  ncol = 6,
  byrow = T
) 

array2d_ipix_idepth_chl_data <- c(
  c(0.282579,0.285409,0.288703,0.292495,0.296817,0.301702,0.307180,0.313277,0.320018,0.327422,0.335505,0.344276,0.353738,0.363886,0.374709,0.386185,0.398286,0.410972,0.424194,0.437894,0.452004,0.466445,0.481129,0.495963,0.510840,0.525652,0.540281,0.554607,0.568507,0.581854,0.594524,0.606395,0.617348,0.627270,0.636055,0.643606,0.649838,0.654677,0.658062,0.659947,0.660302,0.659110,0.656372,0.652104,0.646339,0.639124,0.630520,0.620601,0.609454,0.597176,0.583874,0.569660,0.554655,0.538980,0.522760,0.506121,0.489187,0.472077,0.454907,0.437789,0.420825,0.404111,0.387733,0.371768,0.356286,0.341342,0.326987,0.313258,0.300184,0.287786,0.276074,0.265053,0.254720,0.245065,0.236073,0.227722,0.219990,0.212849,0.206268,0.200216,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000),
  rep(-999., times = 101),
  c(51.346355, 54.653086, 59.353554, 64.846223, 69.99886, 73.420727, 73.950885, 71.134465, 65.421479, 57.970096, 50.17125, 43.159635, 37.539974, 33.39117, 30.45346, 28.350487, 26.744011, 25.396499, 24.168568, 22.98983, 21.829195, 20.674541, 19.521663, 18.369261, 17.216974, 16.064711, 14.912454, 13.760198, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
)
array2d_ipix_idepth_chl <- matrix(
  data = array2d_ipix_idepth_chl_data,
  nrow = 3,
  ncol = 101,
  byrow = T
)

array2d_ipix_idepth_pp_data <- c(
  c(9.118717,9.018018,8.917326,8.814083,8.705796,8.590115,8.464941,8.328705,8.180645,8.021092,7.851724,7.675623,7.497126,7.321372,7.153584,6.998258,6.858423,6.735135,6.627339,6.532056,6.444791,6.360121,6.272329,6.175904,6.065991,5.938717,5.791350,5.622409,5.431608,5.219792,4.988797,4.741247,4.480352,4.209700,3.933050,3.654150,3.376581,3.103622,2.838167,2.582667,2.339098,2.108965,1.893320,1.692804,1.507684,1.337911,1.183172,1.042944,0.916546,0.803181,0.701975,0.612015,0.532372,0.462127,0.400389,0.346303,0.299064,0.138529,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA),
  rep(-999., times = 100),
  c(1530.236572, 1130.647217, 816.774109, 589.615479, 372.457458, 203.330704, 101.050201, 48.006691, 22.588902, 7.258544, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA)
)

array2d_ipix_idepth_pp <- matrix(
  data = array2d_ipix_idepth_pp_data,
  nrow = 3,
  ncol = 100,
  byrow = T
)

array1d_ipix_lat <- c(68.7678604126, 68.8391189575, 68.8391189575)

array1d_ipix_lon <- c(-104.8845291138, -104.9694976807, -104.9694976807)

array3d_ipix_itime_ivis_Ed0minus_data = c(
  c(1.72806832041191e-06, 1.69458047144721e-06, 1.65591260793789e-06, 2.00838036445362e-06, 1.65493204412483e-06, 1.92706714604678e-06, 1.32051053843762e-06, 1.98338222954953e-06, 2.17539955493464e-06, 2.42241183432027e-06, 2.59580469193689e-06, 2.6227472516417e-06, 2.65322965250027e-06, 2.69832802590053e-06, 2.80078236367429e-06, 2.94581114595541e-06, 2.9135648503777e-06, 2.90098844492625e-06, 3.06482253905464e-06, 3.0907169083612e-06, 2.85346957258537e-06, 2.96938350690459e-06, 2.98959278998202e-06, 2.89538113425207e-06, 2.91507694257319e-06, 3.06124762127946e-06, 2.99390767947296e-06, 3.05404955929164e-06, 3.09713517153963e-06, 3.17513739191675e-06, 3.11696522513514e-06, 3.24197816826637e-06, 3.0385360085389e-06, 3.21567922746509e-06, 3.06508892516863e-06, 3.09665685922203e-06, 3.23615591369522e-06, 3.28857328986142e-06, 2.81298433770872e-06, 3.00411624669697e-06, 3.21910636761492e-06, 3.36474598407399e-06, 3.24782036603318e-06, 3.27832910705459e-06, 3.33159126880837e-06, 3.17077310061e-06, 3.13981273081414e-06, 3.29187470991723e-06, 3.27877021984556e-06, 3.35093087082241e-06, 3.07807523175286e-06, 3.18717002128433e-06, 3.36747287104042e-06, 3.42313283035112e-06, 3.47026496899706e-06, 3.43838723610055e-06, 3.4449132780909e-06, 3.4628391125068e-06, 2.9753991745071e-06, 3.00403362441737e-06, 3.0769866745966e-06,
    7.20241013338978e-07, 7.06056038394105e-07, 6.8980033145638e-07, 8.36373281137068e-07, 6.89169246037916e-07, 8.02461890019865e-07, 5.49731881618371e-07, 8.25440991259869e-07, 9.05078914616385e-07, 1.00727468396964e-06, 1.07979662521244e-06, 1.09117202363666e-06, 1.10261576417388e-06, 1.12123589088681e-06, 1.16305343203029e-06, 1.21586764771437e-06, 1.20130769716253e-06, 1.20072556438783e-06, 1.27016032886143e-06, 1.27971270084727e-06, 1.1772524473772e-06, 1.22046126924367e-06, 1.22912342236554e-06, 1.18999876207208e-06, 1.19497696765775e-06, 1.25020912706952e-06, 1.21715278655681e-06, 1.23912661532149e-06, 1.25603475672296e-06, 1.28570070768008e-06, 1.25919705422492e-06, 1.30488184741052e-06, 1.21753247025601e-06, 1.27947850987214e-06, 1.19796243329486e-06, 1.20328226136463e-06, 1.26814824448991e-06, 1.30591780999293e-06, 1.08259255444187e-06, 1.1642349722059e-06, 1.27319447849782e-06, 1.3391537623671e-06, 1.2969804547649e-06, 1.31324304020667e-06, 1.33634491648837e-06, 1.26958726927603e-06, 1.24430816731625e-06, 1.32239269649907e-06, 1.33543385255072e-06, 1.36896782529804e-06, 1.25482971111001e-06, 1.29653970468047e-06, 1.39077656964848e-06, 1.42414458748049e-06, 1.45134270828773e-06, 1.44298898771273e-06, 1.44788529301385e-06, 1.45657228802102e-06, 1.1893855892314e-06, 1.21442164948661e-06, 1.2525417573453e-06,
    4.60986619335535e-08, 4.51186302133835e-08, 4.40070593342348e-08, 5.31912353417967e-08, 4.38191061276888e-08, 5.09082703752694e-08, 3.47002534409383e-08, 5.1778201328885e-08, 5.64157551784077e-08, 6.23968756671982e-08, 6.66307619930575e-08, 6.68721348897652e-08, 6.62462449658675e-08, 6.69754748043102e-08, 6.94073258991208e-08, 7.06869221680052e-08, 6.7392225907664e-08, 6.59057739634065e-08, 6.9868138152497e-08, 6.88719416667378e-08, 5.96832123454528e-08, 5.81779149731096e-08, 5.81066367611283e-08, 5.53479228169656e-08, 5.30666547067867e-08, 5.26267922541167e-08, 4.80514925952004e-08, 4.66796131931789e-08, 4.5722426398904e-08, 4.50294844740937e-08, 4.20232564491959e-08, 4.1011249493709e-08, 3.58710776377937e-08, 3.53634463456147e-08, 3.1907714482397e-08, 3.04485191473484e-08, 3.19930698054539e-08, 3.39487052773972e-08, 2.97454673262705e-08, 3.14322570816493e-08, 3.09000368511732e-08, 3.11959092899627e-08, 3.11753115719017e-08, 3.29876361375083e-08, 3.48182235255051e-08, 3.39846769538286e-08, 3.47099387698837e-08, 3.8603917046102e-08, 4.19998675090864e-08, 4.61532929592869e-08, 4.46658220645495e-08, 4.80583605112502e-08, 5.29674021729425e-08, 5.56288440053088e-08, 5.90766236522722e-08, 6.11596328114052e-08, 6.33358411182274e-08, 6.5662599089627e-08, 5.44110501423679e-08, 5.94234210597115e-08, 6.22928827646614e-08,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    4.90996389207164e-07, 4.80916291259457e-07, 4.69450697266512e-07, 5.68677237223341e-07, 4.68236696067268e-07, 5.44760470290529e-07, 3.72823557877506e-07, 5.59229563404902e-07, 6.12549504033412e-07, 6.80947478482389e-07, 7.29454497809247e-07, 7.36500198712915e-07, 7.42991434374428e-07, 7.54838779438238e-07, 7.8218797646939e-07, 8.14635748901143e-07, 8.03297066240627e-07, 8.03202982771664e-07, 8.49525948152111e-07, 8.54589814183451e-07, 7.83478423945309e-07, 8.09369476150663e-07, 8.14519966331593e-07, 7.87693129309526e-07, 7.88855061428833e-07, 8.22565966362394e-07, 7.97705164748262e-07, 8.10150166638491e-07, 8.20001129205561e-07, 8.37666997059478e-07, 8.18296571091793e-07, 8.45229870322628e-07, 7.85731826218807e-07, 8.21672697247117e-07, 7.6307716772817e-07, 7.62738519306947e-07, 8.06005472411716e-07, 8.35636035948509e-07, 6.85184630461946e-07, 7.38372162730412e-07, 8.11752069323769e-07, 8.54586226653769e-07, 8.29048626301366e-07, 8.40881496870361e-07, 8.56252485729799e-07, 8.12613861213115e-07, 7.93041358096939e-07, 8.48451769739872e-07, 8.62960469087512e-07, 8.87038829981278e-07, 8.12991684273964e-07, 8.39616354521063e-07, 9.06286640970562e-07, 9.30725315340158e-07, 9.51022270356362e-07, 9.47250906981592e-07, 9.51101411579501e-07, 9.57265017421031e-07, 7.63129327961476e-07, 7.85028680149357e-07, 8.12259001121117e-07,
    1.49181957597264e-06, 1.46325197237245e-06, 1.43021863253157e-06, 1.7350514571206e-06, 1.43008152863954e-06, 1.66567659995172e-06, 1.14165019237567e-06, 1.7151079791504e-06, 1.88154583460738e-06, 2.09552130654776e-06, 2.24620334521417e-06, 2.27012383760876e-06, 2.29670472448351e-06, 2.33622955897312e-06, 2.42518233527745e-06, 2.54893230444193e-06, 2.52133039993479e-06, 2.51260053699761e-06, 2.65551587542318e-06, 2.67816892216853e-06, 2.47193690524691e-06, 2.57160018309936e-06, 2.58969336717258e-06, 2.50844580659404e-06, 2.52510983982088e-06, 2.65087621078227e-06, 2.59145130574812e-06, 2.64331916797962e-06, 2.68097113764956e-06, 2.74842625165666e-06, 2.69771563771751e-06, 2.80493149446752e-06, 2.62769807530077e-06, 2.77852290683269e-06, 2.64106745147077e-06, 2.66674992898173e-06, 2.79107253897695e-06, 2.84191823762995e-06, 2.41797963704675e-06, 2.58550434871365e-06, 2.78090729005577e-06, 2.91037564801673e-06, 2.81076452054053e-06, 2.83854941124731e-06, 2.88534566934109e-06, 2.74550953751316e-06, 2.7142363131475e-06, 2.85165475350188e-06, 2.84620185039701e-06, 2.90978849716948e-06, 2.67173848614132e-06, 2.76538343404901e-06, 2.92909487765845e-06, 2.9811641662404e-06, 3.02465953134591e-06, 2.99847389375537e-06, 3.00493843179918e-06, 3.0209536777136e-06, 2.57502646476577e-06, 2.6038819705716e-06, 2.6700458308007e-06,
    2.11340019770729e-06, 2.07135951838108e-06, 2.02301705472321e-06, 2.45239273151781e-06, 2.01972320598339e-06, 2.35061316899769e-06, 1.60998419819889e-06, 2.41706180309666e-06, 2.64991116481519e-06, 2.94972864531095e-06, 3.15913247875227e-06, 3.19033862693939e-06, 3.22657217167611e-06, 3.28009143692293e-06, 3.40376342355829e-06, 3.58288966999789e-06, 3.54261455042182e-06, 3.5229117960005e-06, 3.71963304718318e-06, 3.75022137044377e-06, 3.46304390130245e-06, 3.60461887002082e-06, 3.6277196496144e-06, 3.5124313204542e-06, 3.5366517295145e-06, 3.71503970174087e-06, 3.6349049786961e-06, 3.70788390301521e-06, 3.75917912017262e-06, 3.85349977916324e-06, 3.78327044955148e-06, 3.93646454010747e-06, 3.69125765532778e-06, 3.91034577665456e-06, 3.74086982829879e-06, 3.78161146420493e-06, 3.94385292448165e-06, 3.99749331308327e-06, 3.44421573999917e-06, 3.67192975883493e-06, 3.91444386134946e-06, 4.08426963269088e-06, 3.93950799557106e-06, 3.97397747369836e-06, 4.0372300453816e-06, 3.84316195372013e-06, 3.81400010623358e-06, 3.98770681414514e-06, 3.96103204961076e-06, 4.04685758090587e-06, 3.71953329973869e-06, 3.85340871380887e-06, 4.05785632612749e-06, 4.11809716125065e-06, 4.17033904116558e-06, 4.12914674578163e-06, 4.13558624017766e-06, 4.1564538765196e-06, 3.60969845254403e-06, 3.63702626751465e-06, 3.71983454781552e-06,
    1.73279285892185e-06, 1.69920289269732e-06, 1.66042067344925e-06, 2.01383770981564e-06, 1.65941799184352e-06, 1.93228230266417e-06, 1.32407753752393e-06, 1.98872697365398e-06, 2.18125157570461e-06, 2.42891866466487e-06, 2.60276131680523e-06, 2.62976337586864e-06, 2.66031795707129e-06, 2.7055234573e-06, 2.80824635724527e-06, 2.9536944327679e-06, 2.92135442245546e-06, 2.9086940202382e-06, 3.07294076525546e-06, 3.09890212584218e-06, 2.86103129074234e-06, 2.9772706780248e-06, 2.99752286125659e-06, 2.90304912634661e-06, 2.92280032660264e-06, 3.06937576041586e-06, 3.00187904845885e-06, 3.06218517821545e-06, 3.10537376255214e-06, 3.1835792082971e-06, 3.12526239708234e-06, 3.25062137010465e-06, 3.04666305509686e-06, 3.2243270874607e-06, 3.0734878278039e-06, 3.10517534919929e-06, 3.24496136855207e-06, 3.29740933951193e-06, 2.82081839710986e-06, 3.01241312376522e-06, 3.22777270476314e-06, 3.37372288741741e-06, 3.25644639110733e-06, 3.28701154761625e-06, 3.34039993794364e-06, 3.17916222331698e-06, 3.14822144091851e-06, 3.30056146563653e-06, 3.28729953211578e-06, 3.35962783745602e-06, 3.08608695179407e-06, 3.19549102116291e-06, 3.37611309144004e-06, 3.43184010118251e-06, 3.4790351532296e-06, 3.44704315805214e-06, 3.45357150539195e-06, 3.47153246914375e-06, 2.98330754511131e-06, 3.01193035353734e-06, 3.08501715011977e-06
  ),
  c(1.72806832041191e-06, 1.69458047144721e-06, 1.65591260793789e-06, 2.00838036445362e-06, 1.65493204412483e-06, 1.92706714604678e-06, 1.32051053843762e-06, 1.98338222954953e-06, 2.17539955493464e-06, 2.42241183432027e-06, 2.59580469193689e-06, 2.6227472516417e-06, 2.65322965250027e-06, 2.69832802590053e-06, 2.80078236367429e-06, 2.94581114595541e-06, 2.9135648503777e-06, 2.90098844492625e-06, 3.06482253905464e-06, 3.0907169083612e-06, 2.85346957258537e-06, 2.96938350690459e-06, 2.98959278998202e-06, 2.89538113425207e-06, 2.91507694257319e-06, 3.06124762127946e-06, 2.99390767947296e-06, 3.05404955929164e-06, 3.09713517153963e-06, 3.17513739191675e-06, 3.11696522513514e-06, 3.24197816826637e-06, 3.0385360085389e-06, 3.21567922746509e-06, 3.06508892516863e-06, 3.09665685922203e-06, 3.23615591369522e-06, 3.28857328986142e-06, 2.81298433770872e-06, 3.00411624669697e-06, 3.21910636761492e-06, 3.36474598407399e-06, 3.24782036603318e-06, 3.27832910705459e-06, 3.33159126880837e-06, 3.17077310061e-06, 3.13981273081414e-06, 3.29187470991723e-06, 3.27877021984556e-06, 3.35093087082241e-06, 3.07807523175286e-06, 3.18717002128433e-06, 3.36747287104042e-06, 3.42313283035112e-06, 3.47026496899706e-06, 3.43838723610055e-06, 3.4449132780909e-06, 3.4628391125068e-06, 2.9753991745071e-06, 3.00403362441737e-06, 3.0769866745966e-06,
    7.20241013338978e-07, 7.06056038394105e-07, 6.8980033145638e-07, 8.36373281137068e-07, 6.89169246037916e-07, 8.02461890019865e-07, 5.49731881618371e-07, 8.25440991259869e-07, 9.05078914616385e-07, 1.00727468396964e-06, 1.07979662521244e-06, 1.09117202363666e-06, 1.10261576417388e-06, 1.12123589088681e-06, 1.16305343203029e-06, 1.21586764771437e-06, 1.20130769716253e-06, 1.20072556438783e-06, 1.27016032886143e-06, 1.27971270084727e-06, 1.1772524473772e-06, 1.22046126924367e-06, 1.22912342236554e-06, 1.18999876207208e-06, 1.19497696765775e-06, 1.25020912706952e-06, 1.21715278655681e-06, 1.23912661532149e-06, 1.25603475672296e-06, 1.28570070768008e-06, 1.25919705422492e-06, 1.30488184741052e-06, 1.21753247025601e-06, 1.27947850987214e-06, 1.19796243329486e-06, 1.20328226136463e-06, 1.26814824448991e-06, 1.30591780999293e-06, 1.08259255444187e-06, 1.1642349722059e-06, 1.27319447849782e-06, 1.3391537623671e-06, 1.2969804547649e-06, 1.31324304020667e-06, 1.33634491648837e-06, 1.26958726927603e-06, 1.24430816731625e-06, 1.32239269649907e-06, 1.33543385255072e-06, 1.36896782529804e-06, 1.25482971111001e-06, 1.29653970468047e-06, 1.39077656964848e-06, 1.42414458748049e-06, 1.45134270828773e-06, 1.44298898771273e-06, 1.44788529301385e-06, 1.45657228802102e-06, 1.1893855892314e-06, 1.21442164948661e-06, 1.2525417573453e-06,
    4.60986619335535e-08, 4.51186302133835e-08, 4.40070593342348e-08, 5.31912353417967e-08, 4.38191061276888e-08, 5.09082703752694e-08, 3.47002534409383e-08, 5.1778201328885e-08, 5.64157551784077e-08, 6.23968756671982e-08, 6.66307619930575e-08, 6.68721348897652e-08, 6.62462449658675e-08, 6.69754748043102e-08, 6.94073258991208e-08, 7.06869221680052e-08, 6.7392225907664e-08, 6.59057739634065e-08, 6.9868138152497e-08, 6.88719416667378e-08, 5.96832123454528e-08, 5.81779149731096e-08, 5.81066367611283e-08, 5.53479228169656e-08, 5.30666547067867e-08, 5.26267922541167e-08, 4.80514925952004e-08, 4.66796131931789e-08, 4.5722426398904e-08, 4.50294844740937e-08, 4.20232564491959e-08, 4.1011249493709e-08, 3.58710776377937e-08, 3.53634463456147e-08, 3.1907714482397e-08, 3.04485191473484e-08, 3.19930698054539e-08, 3.39487052773972e-08, 2.97454673262705e-08, 3.14322570816493e-08, 3.09000368511732e-08, 3.11959092899627e-08, 3.11753115719017e-08, 3.29876361375083e-08, 3.48182235255051e-08, 3.39846769538286e-08, 3.47099387698837e-08, 3.8603917046102e-08, 4.19998675090864e-08, 4.61532929592869e-08, 4.46658220645495e-08, 4.80583605112502e-08, 5.29674021729425e-08, 5.56288440053088e-08, 5.90766236522722e-08, 6.11596328114052e-08, 6.33358411182274e-08, 6.5662599089627e-08, 5.44110501423679e-08, 5.94234210597115e-08, 6.22928827646614e-08,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    4.90996389207164e-07, 4.80916291259457e-07, 4.69450697266512e-07, 5.68677237223341e-07, 4.68236696067268e-07, 5.44760470290529e-07, 3.72823557877506e-07, 5.59229563404902e-07, 6.12549504033412e-07, 6.80947478482389e-07, 7.29454497809247e-07, 7.36500198712915e-07, 7.42991434374428e-07, 7.54838779438238e-07, 7.8218797646939e-07, 8.14635748901143e-07, 8.03297066240627e-07, 8.03202982771664e-07, 8.49525948152111e-07, 8.54589814183451e-07, 7.83478423945309e-07, 8.09369476150663e-07, 8.14519966331593e-07, 7.87693129309526e-07, 7.88855061428833e-07, 8.22565966362394e-07, 7.97705164748262e-07, 8.10150166638491e-07, 8.20001129205561e-07, 8.37666997059478e-07, 8.18296571091793e-07, 8.45229870322628e-07, 7.85731826218807e-07, 8.21672697247117e-07, 7.6307716772817e-07, 7.62738519306947e-07, 8.06005472411716e-07, 8.35636035948509e-07, 6.85184630461946e-07, 7.38372162730412e-07, 8.11752069323769e-07, 8.54586226653769e-07, 8.29048626301366e-07, 8.40881496870361e-07, 8.56252485729799e-07, 8.12613861213115e-07, 7.93041358096939e-07, 8.48451769739872e-07, 8.62960469087512e-07, 8.87038829981278e-07, 8.12991684273964e-07, 8.39616354521063e-07, 9.06286640970562e-07, 9.30725315340158e-07, 9.51022270356362e-07, 9.47250906981592e-07, 9.51101411579501e-07, 9.57265017421031e-07, 7.63129327961476e-07, 7.85028680149357e-07, 8.12259001121117e-07,
    1.49181957597264e-06, 1.46325197237245e-06, 1.43021863253157e-06, 1.7350514571206e-06, 1.43008152863954e-06, 1.66567659995172e-06, 1.14165019237567e-06, 1.7151079791504e-06, 1.88154583460738e-06, 2.09552130654776e-06, 2.24620334521417e-06, 2.27012383760876e-06, 2.29670472448351e-06, 2.33622955897312e-06, 2.42518233527745e-06, 2.54893230444193e-06, 2.52133039993479e-06, 2.51260053699761e-06, 2.65551587542318e-06, 2.67816892216853e-06, 2.47193690524691e-06, 2.57160018309936e-06, 2.58969336717258e-06, 2.50844580659404e-06, 2.52510983982088e-06, 2.65087621078227e-06, 2.59145130574812e-06, 2.64331916797962e-06, 2.68097113764956e-06, 2.74842625165666e-06, 2.69771563771751e-06, 2.80493149446752e-06, 2.62769807530077e-06, 2.77852290683269e-06, 2.64106745147077e-06, 2.66674992898173e-06, 2.79107253897695e-06, 2.84191823762995e-06, 2.41797963704675e-06, 2.58550434871365e-06, 2.78090729005577e-06, 2.91037564801673e-06, 2.81076452054053e-06, 2.83854941124731e-06, 2.88534566934109e-06, 2.74550953751316e-06, 2.7142363131475e-06, 2.85165475350188e-06, 2.84620185039701e-06, 2.90978849716948e-06, 2.67173848614132e-06, 2.76538343404901e-06, 2.92909487765845e-06, 2.9811641662404e-06, 3.02465953134591e-06, 2.99847389375537e-06, 3.00493843179918e-06, 3.0209536777136e-06, 2.57502646476577e-06, 2.6038819705716e-06, 2.6700458308007e-06,
    2.11340019770729e-06, 2.07135951838108e-06, 2.02301705472321e-06, 2.45239273151781e-06, 2.01972320598339e-06, 2.35061316899769e-06, 1.60998419819889e-06, 2.41706180309666e-06, 2.64991116481519e-06, 2.94972864531095e-06, 3.15913247875227e-06, 3.19033862693939e-06, 3.22657217167611e-06, 3.28009143692293e-06, 3.40376342355829e-06, 3.58288966999789e-06, 3.54261455042182e-06, 3.5229117960005e-06, 3.71963304718318e-06, 3.75022137044377e-06, 3.46304390130245e-06, 3.60461887002082e-06, 3.6277196496144e-06, 3.5124313204542e-06, 3.5366517295145e-06, 3.71503970174087e-06, 3.6349049786961e-06, 3.70788390301521e-06, 3.75917912017262e-06, 3.85349977916324e-06, 3.78327044955148e-06, 3.93646454010747e-06, 3.69125765532778e-06, 3.91034577665456e-06, 3.74086982829879e-06, 3.78161146420493e-06, 3.94385292448165e-06, 3.99749331308327e-06, 3.44421573999917e-06, 3.67192975883493e-06, 3.91444386134946e-06, 4.08426963269088e-06, 3.93950799557106e-06, 3.97397747369836e-06, 4.0372300453816e-06, 3.84316195372013e-06, 3.81400010623358e-06, 3.98770681414514e-06, 3.96103204961076e-06, 4.04685758090587e-06, 3.71953329973869e-06, 3.85340871380887e-06, 4.05785632612749e-06, 4.11809716125065e-06, 4.17033904116558e-06, 4.12914674578163e-06, 4.13558624017766e-06, 4.1564538765196e-06, 3.60969845254403e-06, 3.63702626751465e-06, 3.71983454781552e-06,
    1.73279285892185e-06, 1.69920289269732e-06, 1.66042067344925e-06, 2.01383770981564e-06, 1.65941799184352e-06, 1.93228230266417e-06, 1.32407753752393e-06, 1.98872697365398e-06, 2.18125157570461e-06, 2.42891866466487e-06, 2.60276131680523e-06, 2.62976337586864e-06, 2.66031795707129e-06, 2.7055234573e-06, 2.80824635724527e-06, 2.9536944327679e-06, 2.92135442245546e-06, 2.9086940202382e-06, 3.07294076525546e-06, 3.09890212584218e-06, 2.86103129074234e-06, 2.9772706780248e-06, 2.99752286125659e-06, 2.90304912634661e-06, 2.92280032660264e-06, 3.06937576041586e-06, 3.00187904845885e-06, 3.06218517821545e-06, 3.10537376255214e-06, 3.1835792082971e-06, 3.12526239708234e-06, 3.25062137010465e-06, 3.04666305509686e-06, 3.2243270874607e-06, 3.0734878278039e-06, 3.10517534919929e-06, 3.24496136855207e-06, 3.29740933951193e-06, 2.82081839710986e-06, 3.01241312376522e-06, 3.22777270476314e-06, 3.37372288741741e-06, 3.25644639110733e-06, 3.28701154761625e-06, 3.34039993794364e-06, 3.17916222331698e-06, 3.14822144091851e-06, 3.30056146563653e-06, 3.28729953211578e-06, 3.35962783745602e-06, 3.08608695179407e-06, 3.19549102116291e-06, 3.37611309144004e-06, 3.43184010118251e-06, 3.4790351532296e-06, 3.44704315805214e-06, 3.45357150539195e-06, 3.47153246914375e-06, 2.98330754511131e-06, 3.01193035353734e-06, 3.08501715011977e-06
  ),
  c(1.72806832041191e-06, 1.69458047144721e-06, 1.65591260793789e-06, 2.00838036445362e-06, 1.65493204412483e-06, 1.92706714604678e-06, 1.32051053843762e-06, 1.98338222954953e-06, 2.17539955493464e-06, 2.42241183432027e-06, 2.59580469193689e-06, 2.6227472516417e-06, 2.65322965250027e-06, 2.69832802590053e-06, 2.80078236367429e-06, 2.94581114595541e-06, 2.9135648503777e-06, 2.90098844492625e-06, 3.06482253905464e-06, 3.0907169083612e-06, 2.85346957258537e-06, 2.96938350690459e-06, 2.98959278998202e-06, 2.89538113425207e-06, 2.91507694257319e-06, 3.06124762127946e-06, 2.99390767947296e-06, 3.05404955929164e-06, 3.09713517153963e-06, 3.17513739191675e-06, 3.11696522513514e-06, 3.24197816826637e-06, 3.0385360085389e-06, 3.21567922746509e-06, 3.06508892516863e-06, 3.09665685922203e-06, 3.23615591369522e-06, 3.28857328986142e-06, 2.81298433770872e-06, 3.00411624669697e-06, 3.21910636761492e-06, 3.36474598407399e-06, 3.24782036603318e-06, 3.27832910705459e-06, 3.33159126880837e-06, 3.17077310061e-06, 3.13981273081414e-06, 3.29187470991723e-06, 3.27877021984556e-06, 3.35093087082241e-06, 3.07807523175286e-06, 3.18717002128433e-06, 3.36747287104042e-06, 3.42313283035112e-06, 3.47026496899706e-06, 3.43838723610055e-06, 3.4449132780909e-06, 3.4628391125068e-06, 2.9753991745071e-06, 3.00403362441737e-06, 3.0769866745966e-06,
    7.20241013338978e-07, 7.06056038394105e-07, 6.8980033145638e-07, 8.36373281137068e-07, 6.89169246037916e-07, 8.02461890019865e-07, 5.49731881618371e-07, 8.25440991259869e-07, 9.05078914616385e-07, 1.00727468396964e-06, 1.07979662521244e-06, 1.09117202363666e-06, 1.10261576417388e-06, 1.12123589088681e-06, 1.16305343203029e-06, 1.21586764771437e-06, 1.20130769716253e-06, 1.20072556438783e-06, 1.27016032886143e-06, 1.27971270084727e-06, 1.1772524473772e-06, 1.22046126924367e-06, 1.22912342236554e-06, 1.18999876207208e-06, 1.19497696765775e-06, 1.25020912706952e-06, 1.21715278655681e-06, 1.23912661532149e-06, 1.25603475672296e-06, 1.28570070768008e-06, 1.25919705422492e-06, 1.30488184741052e-06, 1.21753247025601e-06, 1.27947850987214e-06, 1.19796243329486e-06, 1.20328226136463e-06, 1.26814824448991e-06, 1.30591780999293e-06, 1.08259255444187e-06, 1.1642349722059e-06, 1.27319447849782e-06, 1.3391537623671e-06, 1.2969804547649e-06, 1.31324304020667e-06, 1.33634491648837e-06, 1.26958726927603e-06, 1.24430816731625e-06, 1.32239269649907e-06, 1.33543385255072e-06, 1.36896782529804e-06, 1.25482971111001e-06, 1.29653970468047e-06, 1.39077656964848e-06, 1.42414458748049e-06, 1.45134270828773e-06, 1.44298898771273e-06, 1.44788529301385e-06, 1.45657228802102e-06, 1.1893855892314e-06, 1.21442164948661e-06, 1.2525417573453e-06,
    4.60986619335535e-08, 4.51186302133835e-08, 4.40070593342348e-08, 5.31912353417967e-08, 4.38191061276888e-08, 5.09082703752694e-08, 3.47002534409383e-08, 5.1778201328885e-08, 5.64157551784077e-08, 6.23968756671982e-08, 6.66307619930575e-08, 6.68721348897652e-08, 6.62462449658675e-08, 6.69754748043102e-08, 6.94073258991208e-08, 7.06869221680052e-08, 6.7392225907664e-08, 6.59057739634065e-08, 6.9868138152497e-08, 6.88719416667378e-08, 5.96832123454528e-08, 5.81779149731096e-08, 5.81066367611283e-08, 5.53479228169656e-08, 5.30666547067867e-08, 5.26267922541167e-08, 4.80514925952004e-08, 4.66796131931789e-08, 4.5722426398904e-08, 4.50294844740937e-08, 4.20232564491959e-08, 4.1011249493709e-08, 3.58710776377937e-08, 3.53634463456147e-08, 3.1907714482397e-08, 3.04485191473484e-08, 3.19930698054539e-08, 3.39487052773972e-08, 2.97454673262705e-08, 3.14322570816493e-08, 3.09000368511732e-08, 3.11959092899627e-08, 3.11753115719017e-08, 3.29876361375083e-08, 3.48182235255051e-08, 3.39846769538286e-08, 3.47099387698837e-08, 3.8603917046102e-08, 4.19998675090864e-08, 4.61532929592869e-08, 4.46658220645495e-08, 4.80583605112502e-08, 5.29674021729425e-08, 5.56288440053088e-08, 5.90766236522722e-08, 6.11596328114052e-08, 6.33358411182274e-08, 6.5662599089627e-08, 5.44110501423679e-08, 5.94234210597115e-08, 6.22928827646614e-08,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    4.90996389207164e-07, 4.80916291259457e-07, 4.69450697266512e-07, 5.68677237223341e-07, 4.68236696067268e-07, 5.44760470290529e-07, 3.72823557877506e-07, 5.59229563404902e-07, 6.12549504033412e-07, 6.80947478482389e-07, 7.29454497809247e-07, 7.36500198712915e-07, 7.42991434374428e-07, 7.54838779438238e-07, 7.8218797646939e-07, 8.14635748901143e-07, 8.03297066240627e-07, 8.03202982771664e-07, 8.49525948152111e-07, 8.54589814183451e-07, 7.83478423945309e-07, 8.09369476150663e-07, 8.14519966331593e-07, 7.87693129309526e-07, 7.88855061428833e-07, 8.22565966362394e-07, 7.97705164748262e-07, 8.10150166638491e-07, 8.20001129205561e-07, 8.37666997059478e-07, 8.18296571091793e-07, 8.45229870322628e-07, 7.85731826218807e-07, 8.21672697247117e-07, 7.6307716772817e-07, 7.62738519306947e-07, 8.06005472411716e-07, 8.35636035948509e-07, 6.85184630461946e-07, 7.38372162730412e-07, 8.11752069323769e-07, 8.54586226653769e-07, 8.29048626301366e-07, 8.40881496870361e-07, 8.56252485729799e-07, 8.12613861213115e-07, 7.93041358096939e-07, 8.48451769739872e-07, 8.62960469087512e-07, 8.87038829981278e-07, 8.12991684273964e-07, 8.39616354521063e-07, 9.06286640970562e-07, 9.30725315340158e-07, 9.51022270356362e-07, 9.47250906981592e-07, 9.51101411579501e-07, 9.57265017421031e-07, 7.63129327961476e-07, 7.85028680149357e-07, 8.12259001121117e-07,
    1.49181957597264e-06, 1.46325197237245e-06, 1.43021863253157e-06, 1.7350514571206e-06, 1.43008152863954e-06, 1.66567659995172e-06, 1.14165019237567e-06, 1.7151079791504e-06, 1.88154583460738e-06, 2.09552130654776e-06, 2.24620334521417e-06, 2.27012383760876e-06, 2.29670472448351e-06, 2.33622955897312e-06, 2.42518233527745e-06, 2.54893230444193e-06, 2.52133039993479e-06, 2.51260053699761e-06, 2.65551587542318e-06, 2.67816892216853e-06, 2.47193690524691e-06, 2.57160018309936e-06, 2.58969336717258e-06, 2.50844580659404e-06, 2.52510983982088e-06, 2.65087621078227e-06, 2.59145130574812e-06, 2.64331916797962e-06, 2.68097113764956e-06, 2.74842625165666e-06, 2.69771563771751e-06, 2.80493149446752e-06, 2.62769807530077e-06, 2.77852290683269e-06, 2.64106745147077e-06, 2.66674992898173e-06, 2.79107253897695e-06, 2.84191823762995e-06, 2.41797963704675e-06, 2.58550434871365e-06, 2.78090729005577e-06, 2.91037564801673e-06, 2.81076452054053e-06, 2.83854941124731e-06, 2.88534566934109e-06, 2.74550953751316e-06, 2.7142363131475e-06, 2.85165475350188e-06, 2.84620185039701e-06, 2.90978849716948e-06, 2.67173848614132e-06, 2.76538343404901e-06, 2.92909487765845e-06, 2.9811641662404e-06, 3.02465953134591e-06, 2.99847389375537e-06, 3.00493843179918e-06, 3.0209536777136e-06, 2.57502646476577e-06, 2.6038819705716e-06, 2.6700458308007e-06,
    2.11340019770729e-06, 2.07135951838108e-06, 2.02301705472321e-06, 2.45239273151781e-06, 2.01972320598339e-06, 2.35061316899769e-06, 1.60998419819889e-06, 2.41706180309666e-06, 2.64991116481519e-06, 2.94972864531095e-06, 3.15913247875227e-06, 3.19033862693939e-06, 3.22657217167611e-06, 3.28009143692293e-06, 3.40376342355829e-06, 3.58288966999789e-06, 3.54261455042182e-06, 3.5229117960005e-06, 3.71963304718318e-06, 3.75022137044377e-06, 3.46304390130245e-06, 3.60461887002082e-06, 3.6277196496144e-06, 3.5124313204542e-06, 3.5366517295145e-06, 3.71503970174087e-06, 3.6349049786961e-06, 3.70788390301521e-06, 3.75917912017262e-06, 3.85349977916324e-06, 3.78327044955148e-06, 3.93646454010747e-06, 3.69125765532778e-06, 3.91034577665456e-06, 3.74086982829879e-06, 3.78161146420493e-06, 3.94385292448165e-06, 3.99749331308327e-06, 3.44421573999917e-06, 3.67192975883493e-06, 3.91444386134946e-06, 4.08426963269088e-06, 3.93950799557106e-06, 3.97397747369836e-06, 4.0372300453816e-06, 3.84316195372013e-06, 3.81400010623358e-06, 3.98770681414514e-06, 3.96103204961076e-06, 4.04685758090587e-06, 3.71953329973869e-06, 3.85340871380887e-06, 4.05785632612749e-06, 4.11809716125065e-06, 4.17033904116558e-06, 4.12914674578163e-06, 4.13558624017766e-06, 4.1564538765196e-06, 3.60969845254403e-06, 3.63702626751465e-06, 3.71983454781552e-06,
    1.73279285892185e-06, 1.69920289269732e-06, 1.66042067344925e-06, 2.01383770981564e-06, 1.65941799184352e-06, 1.93228230266417e-06, 1.32407753752393e-06, 1.98872697365398e-06, 2.18125157570461e-06, 2.42891866466487e-06, 2.60276131680523e-06, 2.62976337586864e-06, 2.66031795707129e-06, 2.7055234573e-06, 2.80824635724527e-06, 2.9536944327679e-06, 2.92135442245546e-06, 2.9086940202382e-06, 3.07294076525546e-06, 3.09890212584218e-06, 2.86103129074234e-06, 2.9772706780248e-06, 2.99752286125659e-06, 2.90304912634661e-06, 2.92280032660264e-06, 3.06937576041586e-06, 3.00187904845885e-06, 3.06218517821545e-06, 3.10537376255214e-06, 3.1835792082971e-06, 3.12526239708234e-06, 3.25062137010465e-06, 3.04666305509686e-06, 3.2243270874607e-06, 3.0734878278039e-06, 3.10517534919929e-06, 3.24496136855207e-06, 3.29740933951193e-06, 2.82081839710986e-06, 3.01241312376522e-06, 3.22777270476314e-06, 3.37372288741741e-06, 3.25644639110733e-06, 3.28701154761625e-06, 3.34039993794364e-06, 3.17916222331698e-06, 3.14822144091851e-06, 3.30056146563653e-06, 3.28729953211578e-06, 3.35962783745602e-06, 3.08608695179407e-06, 3.19549102116291e-06, 3.37611309144004e-06, 3.43184010118251e-06, 3.4790351532296e-06, 3.44704315805214e-06, 3.45357150539195e-06, 3.47153246914375e-06, 2.98330754511131e-06, 3.01193035353734e-06, 3.08501715011977e-06
  )
)
array3d_ipix_itime_ivis_Ed0minus <- array(
  data = array3d_ipix_itime_ivis_Ed0minus_data,
  dim = c(61, 9, 3)
)

array1d_ipix_depth <- c(-79.900002, -28, -28)
array1d_ipix_province <- c(5, 5, 5)

# Real values
array1d_ipix_cf <- c(0.5822, 0.5822, 0.5822)
array1d_ipix_o3 <- c(276.8, 276.8, 276.8)
array1d_ipix_taucld <- c(5.52, 5.52, 5.52)

# Test values
# array1d_ipix_cf <- c(0.5822, 0.6)
# array1d_ipix_o3 <- c(276.8, 300)
# array1d_ipix_taucld <- c(5.52, 6)

# Ed0minus for the prototype for Mathieu from AM2006225_PP.nc?
array2d_itime_ivis_Ed0minus_data = c(1.75920371586159e-06, 1.72518828170421e-06, 1.68590325224706e-06, 2.0448458537064e-06, 1.6850618168991e-06, 1.96224780192327e-06, 1.34467408697798e-06, 2.01975652105553e-06, 2.21538224611182e-06, 2.46701161317283e-06, 2.64373901119887e-06, 2.67130818569669e-06, 2.70240678174336e-06, 2.74844538135039e-06, 2.85286212500231e-06, 3.0002729023747e-06, 2.96750334687624e-06, 2.95510234653593e-06, 3.12218963496561e-06, 3.14863084269355e-06, 2.9068311888203e-06, 3.02479984630683e-06, 3.04550820523308e-06, 2.94961116494555e-06, 2.96961829919418e-06, 3.11838514149989e-06, 3.04960151127532e-06, 3.11084562060637e-06, 3.15481003765058e-06, 3.23426548803042e-06, 3.17496621277551e-06, 3.30213609082649e-06, 3.09471175424981e-06, 3.27471861704698e-06, 3.12002321168417e-06, 3.15190195313419e-06, 3.29466456176725e-06, 3.34905305470973e-06, 2.86232783728223e-06, 3.05741403546515e-06, 3.27814701650118e-06, 3.42714698618195e-06, 3.30832437607877e-06, 3.33965583612409e-06, 3.39404023439861e-06, 3.23010781409374e-06, 3.19775914060408e-06, 3.35371000349887e-06, 3.34142834933226e-06, 3.41513014920756e-06, 3.13683692132644e-06, 3.24782227993379e-06, 3.43288790831735e-06, 3.4902971636404e-06, 3.53879719027046e-06, 3.50657459522154e-06, 3.51337332149448e-06, 3.53172566718697e-06, 3.03081988315244e-06, 3.06072026232093e-06, 3.13558909269387e-06,
                                     6.96570167144277e-07, 6.82739698429866e-07, 6.66915551241714e-07, 8.08487572691365e-07, 6.66098039607021e-07, 7.75483480331476e-07, 5.31157290310618e-07, 7.97407231005925e-07, 8.74184324636006e-07, 9.7269786093411e-07, 1.04261242649778e-06, 1.05344866996515e-06, 1.06420020996538e-06, 1.082005404235e-06, 1.12215435101097e-06, 1.17228944568197e-06, 1.15789179673631e-06, 1.15749681182207e-06, 1.22442641065159e-06, 1.23332500184481e-06, 1.13393221425486e-06, 1.17486096397791e-06, 1.18307220880408e-06, 1.14521240479584e-06, 1.14949050828923e-06, 1.20194597723322e-06, 1.16940023009218e-06, 1.19005344421198e-06, 1.20603162300926e-06, 1.23411991408573e-06, 1.20817913535502e-06, 1.25133880633509e-06, 1.16684953284349e-06, 1.22516635732795e-06, 1.14526236162223e-06, 1.14940249454181e-06, 1.21208768465363e-06, 1.24978213957602e-06, 1.03357464547096e-06, 1.11205378557968e-06, 1.21772531532607e-06, 1.28120520484004e-06, 1.24123525440727e-06, 1.25717749689591e-06, 1.27943705197112e-06, 1.21526943648583e-06, 1.19001986856166e-06, 1.26630283468074e-06, 1.28049980649164e-06, 1.313218720186e-06, 1.20361354738244e-06, 1.24344905616067e-06, 1.33551481352607e-06, 1.368367415012e-06, 1.39518875048186e-06, 1.38761505543511e-06, 1.39249254223995e-06, 1.40095734900677e-06, 1.13866490704275e-06, 1.16411188204169e-06, 1.20139901107871e-06,
                                     7.5120389717999e-08, 7.35205626239334e-08, 7.17060558699401e-08, 8.66990972895863e-08, 7.13892911819711e-08, 8.29438771800517e-08, 5.65815102441238e-08, 8.45248277298241e-08, 9.22011289894872e-08, 1.02081498527234e-07, 1.09069900238774e-07, 1.09619909257694e-07, 1.09142918526015e-07, 1.10456047603926e-07, 1.14380384539129e-07, 1.17086153458382e-07, 1.12762910559977e-07, 1.1114733139358e-07, 1.17721232771177e-07, 1.16732388359355e-07, 1.02905255739234e-07, 1.02091599300539e-07, 1.02191019689325e-07, 9.77804304491624e-08, 9.5000161603904e-08, 9.56324206134317e-08, 8.89002266303736e-08, 8.75615037613338e-08, 8.66849119433637e-08, 8.63505922393741e-08, 8.17296374418988e-08, 8.11465839773296e-08, 7.22707838957931e-08, 7.23986406109837e-08, 6.57146179300184e-08, 6.32576365486975e-08, 6.66466272027428e-08, 7.08607462844445e-08, 6.07854465675573e-08, 6.46744498374124e-08, 6.61171883299376e-08, 6.76269127627428e-08, 6.70346465330874e-08, 7.00194651923093e-08, 7.29969147610185e-08, 7.0373963392011e-08, 7.04146154272378e-08, 7.78368782327032e-08, 8.32674495821122e-08, 8.98396174776618e-08, 8.53490860227144e-08, 9.0430829526691e-08, 9.9278776550116e-08, 1.03402305745201e-07, 1.08550193346332e-07, 1.10917132664139e-07, 1.13521204554748e-07, 1.16351095094133e-07, 9.1859569925603e-08, 1.00297309451743e-07, 1.04810026183179e-07,
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                     1.52120060757902e-07, 1.48858510067636e-07, 1.45165305937017e-07, 1.7557805354985e-07, 1.44479817758052e-07, 1.67872229906564e-07, 1.14627511968117e-07, 1.714761582246e-07, 1.8731171534691e-07, 2.07644631977617e-07, 2.22021025831493e-07, 2.23530449550605e-07, 2.23910280663663e-07, 2.26886845320797e-07, 2.34763997208796e-07, 2.41841811113044e-07, 2.35717217669617e-07, 2.34427865560159e-07, 2.48013659727625e-07, 2.47639550400762e-07, 2.22719033226203e-07, 2.25571012628137e-07, 2.26329953853252e-07, 2.17676135262344e-07, 2.14777311624532e-07, 2.2005836126922e-07, 2.08982292179928e-07, 2.0916441718566e-07, 2.09573785397971e-07, 2.11528701530887e-07, 2.03533968492419e-07, 2.06267431278653e-07, 1.87776392130907e-07, 1.91963250576512e-07, 1.75339043078644e-07, 1.71318833176277e-07, 1.81142749407701e-07, 1.91677194891341e-07, 1.58793157282018e-07, 1.704284734718e-07, 1.83004382222289e-07, 1.90450967072314e-07, 1.86659512820908e-07, 1.91800736810252e-07, 1.97097048954375e-07, 1.87678910541658e-07, 1.83704886683084e-07, 2.00908657532933e-07, 2.10150249656729e-07, 2.21064198585782e-07, 2.05425233649888e-07, 2.1404737334708e-07, 2.34001318452786e-07, 2.42090478592278e-07, 2.50678525221725e-07, 2.52529951847658e-07, 2.55380396178425e-07, 2.58809530374433e-07, 1.97251399730059e-07, 2.11491069009827e-07, 2.20430429131884e-07,
                                     8.93339542430316e-07, 8.76045005956963e-07, 8.56150849494347e-07, 1.03842995950171e-06, 8.55896764867079e-07, 9.96885839888395e-07, 6.83156766176235e-07, 1.02614059291525e-06, 1.12553197695372e-06, 1.25311016417197e-06, 1.34359192730764e-06, 1.35808375362264e-06, 1.37307869088317e-06, 1.39666161823316e-06, 1.44928196109908e-06, 1.51744578048647e-06, 1.50014716837774e-06, 1.49871602810032e-06, 1.5853021827123e-06, 1.59799188197825e-06, 1.47174662456622e-06, 1.52759057579741e-06, 1.53869406933111e-06, 1.49019307843477e-06, 1.49775481983979e-06, 1.56878316002754e-06, 1.52936959509963e-06, 1.55814911509466e-06, 1.58001468533107e-06, 1.61833282642482e-06, 1.58626989663368e-06, 1.64563152228736e-06, 1.5374458198486e-06, 1.61863015238831e-06, 1.52123371950939e-06, 1.53058628047594e-06, 1.61065571040747e-06, 1.65379237084024e-06, 1.37915460486154e-06, 1.48133354125098e-06, 1.61435854549015e-06, 1.6964413877694e-06, 1.64186596162587e-06, 1.6613374861275e-06, 1.69013163464143e-06, 1.60644150995244e-06, 1.57778005622575e-06, 1.67191716134482e-06, 1.68328917175548e-06, 1.72406195244895e-06, 1.580806913152e-06, 1.63396417849584e-06, 1.74743700968458e-06, 1.78680950526577e-06, 1.81888279242759e-06, 1.80706914169551e-06, 1.81267805021393e-06, 1.82324609250394e-06, 1.50491403862871e-06, 1.53241202560005e-06, 1.57823549347851e-06,
                                     1.94807866484883e-06, 1.90998410793007e-06, 1.86606050073818e-06, 2.26287035288786e-06, 1.86428654086123e-06, 2.17044927096162e-06, 1.48704489410573e-06, 2.23315900973082e-06, 2.44898422448672e-06, 2.72672688249159e-06, 2.92132139077201e-06, 2.95111981155227e-06, 2.98516708310705e-06, 3.03547095152355e-06, 3.15045773734634e-06, 3.31471479947377e-06, 3.27810419941168e-06, 3.26238391148216e-06, 3.44584225054463e-06, 3.47470489965556e-06, 3.20829509570665e-06, 3.33901906159875e-06, 3.36126105543472e-06, 3.25500407282962e-06, 3.27730704539759e-06, 3.44210824047733e-06, 3.36702675656913e-06, 3.43469966204826e-06, 3.48281788186713e-06, 3.57047887125573e-06, 3.50522185701939e-06, 3.64637610758044e-06, 3.41828197297652e-06, 3.61907277379909e-06, 3.45458515861551e-06, 3.49106261873112e-06, 3.64536813633502e-06, 3.70064461802154e-06, 3.17448224784823e-06, 3.3878960726196e-06, 3.62303196154565e-06, 3.78443409106992e-06, 3.65169347222667e-06, 3.68507594396527e-06, 3.74450987181155e-06, 3.56410869651085e-06, 3.53237632504183e-06, 3.69938467537513e-06, 3.68069782260732e-06, 3.76113580901187e-06, 3.45566527859907e-06, 3.578872767067e-06, 3.77636592382084e-06, 3.83628680103605e-06, 3.88745924383638e-06, 3.85067405549382e-06, 3.85745390655702e-06, 3.87727621541386e-06, 3.34556865872155e-06, 3.37502694182829e-06, 3.45499961173724e-06,
                                     2.36582728429555e-06, 2.31821218169433e-06, 2.26356187754222e-06, 2.74336584245422e-06, 2.25883836145257e-06, 2.6282937027365e-06, 1.79979869356908e-06, 2.70148015985689e-06, 2.96115495305283e-06, 3.29564257079178e-06, 3.52880177280834e-06, 3.56291520480542e-06, 3.60291233553274e-06, 3.66204114670556e-06, 3.79965839362108e-06, 4.00059744499119e-06, 3.95506994660741e-06, 3.93127001727153e-06, 4.14982742276598e-06, 4.18348831037831e-06, 3.86321705168066e-06, 4.0213764386949e-06, 4.04656117952454e-06, 3.91742387269323e-06, 3.94445317550568e-06, 4.14377244615366e-06, 4.05488600984554e-06, 4.13615850020092e-06, 4.1928419471663e-06, 4.29797531801937e-06, 4.21950936761426e-06, 4.39080518433594e-06, 4.11814970967249e-06, 4.36383787707661e-06, 4.17989235334712e-06, 4.22614901402452e-06, 4.40426046312572e-06, 4.46028325871129e-06, 3.85276291205976e-06, 4.1050242945953e-06, 4.368061499211e-06, 4.55463372308041e-06, 4.39211933525086e-06, 4.42957434164768e-06, 4.49939952259678e-06, 4.28346799526832e-06, 4.25423759903606e-06, 4.44374801562456e-06, 4.41012113858783e-06, 4.50510813247253e-06, 4.14155008278934e-06, 4.2913438581592e-06, 4.51365579071996e-06, 4.57821760268083e-06, 4.63460300704807e-06, 4.58761752543928e-06, 4.59425643225431e-06, 4.61703436694643e-06, 4.024567145676e-06, 4.05233580965593e-06, 4.14206575996942e-06,
                                     1.76480813855563e-06, 1.73067417497061e-06, 1.69125389942264e-06, 2.05132482685053e-06, 1.69038825051593e-06, 1.96843603472395e-06, 1.34890901132459e-06, 2.02610491954339e-06, 2.22233564028015e-06, 2.47474012345138e-06, 2.65200337462735e-06, 2.67964151134404e-06, 2.71083179968274e-06, 2.75699767772713e-06, 2.86173297115644e-06, 3.00964627618663e-06, 2.97676230710266e-06, 2.96426730822512e-06, 3.13184708672208e-06, 3.15835794916779e-06, 2.91583069908444e-06, 3.0341775926749e-06, 3.05493745707031e-06, 2.95873475684936e-06, 2.97880954746446e-06, 3.12805650032145e-06, 3.05908641205565e-06, 3.12052148557018e-06, 3.16461170830774e-06, 3.2443172491208e-06, 3.18483716057061e-06, 3.31242692355896e-06, 3.10438141095898e-06, 3.28500911477152e-06, 3.13001491224915e-06, 3.1620300632372e-06, 3.30514592787031e-06, 3.3595669116095e-06, 2.87164501371132e-06, 3.06728065454069e-06, 3.28846260976555e-06, 3.43783297845374e-06, 3.31860351104984e-06, 3.34999524602077e-06, 3.40453338307332e-06, 3.24010762120835e-06, 3.20776849953095e-06, 3.36406396984897e-06, 3.35159038979708e-06, 3.42549546627276e-06, 3.14638818144154e-06, 3.25773464947832e-06, 3.44318115587723e-06, 3.50067181132734e-06, 3.54925349760995e-06, 3.51689670070801e-06, 3.52369655390828e-06, 3.54209003327453e-06, 3.04023938705434e-06, 3.07013397893194e-06, 3.14515552774355e-06
)

missval <- -999.

#============================================================================
# Main.

###########################################################
## Write NetCDF Rrs file.
ipix <- ncdim_def(name = "ipix",
                      units = "unitless",
                      vals = 1:3
                      )
Rrs412 <- ncvar_def(
  name = "Rrs412",
  units = "sr^-1",
  dim = ipix,
  missval = missval,
  compression = 9
)
Rrs443 <- ncvar_def(
  name = "Rrs443",
  units = "sr^-1",
  dim = ipix,
  missval = missval,
  compression = 9
)
Rrs488 <- ncvar_def(
  name = "Rrs488",
  units = "sr^-1",
  dim = ipix,
  missval = missval,
  compression = 9
)
Rrs531 <- ncvar_def(
  name = "Rrs531",
  units = "sr^-1",
  dim = ipix,
  missval = missval,
  compression = 9
)
Rrs555 <- ncvar_def(
  name = "Rrs555",
  units = "sr^-1",
  dim = ipix,
  missval = missval,
  compression = 9
)
Rrs667 <- ncvar_def(
  name = "Rrs667",
  units = "sr^-1",
  dim = ipix,
  missval = missval,
  compression = 9
)
nc_Rrs <- nc_create(
  filename = "Inputs/Rrs.nc",
  vars = list(Rrs412, Rrs443, Rrs488, Rrs531, Rrs555, Rrs667)
)
ncvar_put(
  nc = nc_Rrs,
  varid = Rrs412,
  vals = array2d_ipix_iband_Rrs[,1]
)
ncvar_put(
  nc = nc_Rrs,
  varid = Rrs443,
  vals = array2d_ipix_iband_Rrs[,2]
)
ncvar_put(
  nc = nc_Rrs,
  varid = Rrs488,
  vals = array2d_ipix_iband_Rrs[,3]
)
ncvar_put(
  nc = nc_Rrs,
  varid = Rrs531,
  vals = array2d_ipix_iband_Rrs[,4]
)
ncvar_put(
  nc = nc_Rrs,
  varid = Rrs555,
  vals = array2d_ipix_iband_Rrs[,5]
)
ncvar_put(
  nc = nc_Rrs,
  varid = Rrs667,
  vals = array2d_ipix_iband_Rrs[,6]
)
nc_close(nc_Rrs)

###########################################################
# Write NetCDF chl file.
idepth <- ncdim_def(
  name = "iz",
  units = "m",
  vals = 1:101
)
chlz <- ncvar_def(
  name = "chlz",
  units = "mgChl-a.m^-3",
  dim = list(idepth, ipix),
  missval = missval,
  compression = 9
)
nc_chl <- nc_create(
  filename = "Inputs/chl.nc",
  vars = chlz
)
ncvar_put(
  nc = nc_chl,
  varid = chlz,
  vals = t(array2d_ipix_idepth_chl)
)
nc_close(nc_chl)

###########################################################
## Write NetCDF pp file.
idepth <- ncdim_def(
  name = "idepth",
  units = "m",
  vals = 1:100
)
pp <- ncvar_def(
  name = "pp",
  units = "mgC.m^-2.d^-1",
  dim = list(idepth, ipix),
  missval = missval,
  compression = 9
)
nc_pp <- nc_create(
  filename = "Inputs/pp.nc",
  vars = pp
)
ncvar_put(
  nc = nc_pp,
  varid = pp,
  vals = t(array2d_ipix_idepth_pp)
)
nc_close(nc_pp)

###########################################################
## Write NetCDF grid file.
lat <- ncvar_def(
  name = "lat",
  units = "degrees North",
  dim = ipix,
  missval = missval
)
lon <- ncvar_def(
  name = "lon",
  units = "degrees East",
  dim = ipix,
  missval = missval,
  compression = 9
)
nc_grid <- nc_create(
  filename = "Inputs/grid.nc",
  vars = list(lat, lon)
)
ncvar_put(
  nc = nc_grid,
  varid = lat,
  vals = array1d_ipix_lat
)
ncvar_put(
  nc = nc_grid,
  varid = lon,
  vals = array1d_ipix_lon
)
nc_close(nc_grid)

###########################################################
## Write NetCDF Ed0minus file.
itime <- ncdim_def(
  name = "itime",
  units = "3 hours",
  vals = seq(0, 24, 3)
)
ivis <- ncdim_def(
  name = "ivis",
  units = "5 nm",
  vals = seq(400, 700, 5)
)
Ed0minus <- ncvar_def(
  name = "Ed0minus",
  units = "umol photons.s^-2.m^-2",
  dim = list(ivis, itime, ipix),
  missval = missval,
  compression = 9
)
nc_Ed0minus <- nc_create(
  filename = "Inputs/Ed0minus.nc",
  vars = Ed0minus
)
ncvar_put(
  nc = nc_Ed0minus,
  varid = Ed0minus,
  vals = array3d_ipix_itime_ivis_Ed0minus
)
nc_close(nc_Ed0minus)

###########################################################
## Write NetCDF bathymetry file.

depth <- ncvar_def(
  name = "Zbot",
  units = "meters",
  dim = ipix,
  missval = -9999.,
  compression = 9
)
province <- ncvar_def(
  name = "province",
  units = "unitless",
  dim = ipix,
  missval = 0,
  longname = "WWF Province",
  prec = "integer",
  compression = 9
)
nc_depth <- nc_create(
  filename = "Inputs/bathymetry.nc",
  vars = list(depth, province)
)
ncvar_put(
  nc = nc_depth,
  varid = depth,
  vals = array1d_ipix_depth
)
ncvar_put(
  nc = nc_depth,
  varid = province,
  vals = array1d_ipix_province
)
nc_close(nc_depth)

###########################################################
## Write atmospheric file.

cf <- ncvar_def(
  name = "CF_mean",
  units = "",
  dim = ipix,
  missval = missval,
  compression = 9
)
o3 <- ncvar_def(
  name = "O3_mean",
  units = "Dobson units",
  dim = ipix,
  missval = missval,
  compression = 9
)
taucld <- ncvar_def(
  name = "TauCld_mean",
  units = "",
  dim = ipix,
  missval = missval,
  compression = 9
)
nc_atm <- nc_create(
  filename = "Inputs/atm.nc",
  vars = list(cf, o3, taucld)
)
ncvar_put(
  nc = nc_atm,
  varid = cf,
  vals = array1d_ipix_cf
)
ncvar_put(
  nc = nc_atm,
  varid = o3,
  vals = array1d_ipix_o3
)
ncvar_put(
  nc = nc_atm,
  varid = taucld,
  vals = array1d_ipix_taucld
)
nc_close(nc_atm)

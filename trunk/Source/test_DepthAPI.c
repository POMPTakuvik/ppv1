// 
//  test_DepthAPI.c
//  
//  Created by Maxime Benoit-Gagne on 2017-01-05.
//  Takuvik - Canada.
//  
//  compiler:
//  $ g++ -v
//  Configured with: --prefix=/Applications/Xcode.app/Contents/Developer/usr --with-gxx-include-dir=/usr/include/c++/4.2.1
//  Apple LLVM version 5.1 (clang-503.0.40) (based on LLVM 3.4svn)
//  Target: x86_64-apple-darwin12.6.0
//  Thread model: posix
//  
//  usage:
//  ./test_DepthAPI
//  
//  description: Test DepthAPI.{c,h}.
//  
//  uses: 
//  
//  keywords: C, API

#include <stdio.h>
#include <stdlib.h>

#include "DepthAPI.h"
#include "general.h"

/* ================================= MAIN ================================= */

int main(int argc, char *argv[]){
  
  char errmsg[] = "Bad number of arguments.\n"
  "Usage:\n"
  "./HelloWorld\n";
  
  /////////// Declaration of the variables. ///////////
  
  /////////// Verification of the arguments. ///////////
  if(argc != 1){
    printf("%s", errmsg);
    return -1;
  }
  
  /////////// HelloWorld ///////////

  printf("Hello World!\n");
  
  /////////// Test of Depth ///////////
  printf("Test of class Depth\n");
  printf("Test 1) deep water\n");
  
  float array2d_idepthphy_itime_PAR[NBDEPTHS][NTIMES] = {
    {100., 100., 100., 100., 100., 100., 100., 100., 100.}, // idepthphy = 0
    {95, 95., 95., 95., 95., 95., 95., 95., 95.},           // idepthphy = 1
    {85., 85., 85., 85., 85., 85., 85., 85., 85.},          // idepthphy = 2
    {75., 75., 75., 75., 75., 75., 75., 75., 75.},          // idepthphy = 3
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},
    {75., -999., 75., 75., 75., 75., 75., 75., 75.},  // idepthphy = 97
    {0.15, -999., 15., 15., 15., 15., 15., 15., 15.}, // idepthphy = 98
    {0.05, -999., 15., 15., 15., 15., 15., 15., 15.}, // idepthphy = 99
    {0.01, -999., 5., 5., 5., 5., 5., 5., 5.}         // idepthphy = 100
  };
  int idepthphy_max = 101;
  float depthphy_step = 1.;

  void *depth;

  depth = Depth_create(array2d_idepthphy_itime_PAR,
		       idepthphy_max,
		       depthphy_step);
  
  int s_size = 100000;
  char depthInfo_s[s_size];
  Depth_to_string(depth,
		  depthInfo_s,
		  s_size);
  printf("%s\n", depthInfo_s);
  
  /*
   *  Array of dimension NTIMES = 9.
   *  The first dimension is the hours UTC from 0 to 24 by step of 3 h.
   *  Units: hour.
   *  The values are the indices of the physical depth for which the primary
   *  productivity will be computed.
   *  Units: unitless because it is indices.
   */
  int array1d_itime_idepthphy_max[NTIMES]
  = {-1, -1, -1, -1, -1, -1, -1, -1, -1};
  
  int array1d_itime_idepthphy_max_ref[NTIMES]
  = {100, 4, 101, 101, 101, 101, 101, 101, 101};
  Depth_get_array1d_itime_idepthphy_max(depth,
					array1d_itime_idepthphy_max);
  Depth_delete(depth);
  if(!compare_arrays_i(array1d_itime_idepthphy_max,
                       array1d_itime_idepthphy_max_ref,
                       NTIMES)){
    printf("PASS\n\n");
  }else{
    printf("FAIL\n\n");
  }
  
  printf("Test 2) shallow water\n");
  idepthphy_max = 3;

  depth = Depth_create(array2d_idepthphy_itime_PAR,
		       idepthphy_max,
		       depthphy_step);
  Depth_to_string(depth,
		  depthInfo_s,
		  s_size);
  printf("%s\n", depthInfo_s);
  
  /*
   *  Array of dimension NTIMES = 9.
   *  The first dimension is the hours UTC from 0 to 24 by step of 3 h.
   *  Units: hour.
   *  The values are the indices of the physical depth for which the primary
   *  productivity will be computed.
   *  Units: unitless because it is indices.
   */
  int array1d_itime_idepthphy_max2[NTIMES]
  = {-1, -1, -1, -1, -1, -1, -1, -1, -1};
  
  int array1d_itime_idepthphy_max_ref2[NTIMES]
  = {3, 3, 3, 3, 3, 3, 3, 3, 3};
  Depth_get_array1d_itime_idepthphy_max(depth,
					array1d_itime_idepthphy_max2);
  Depth_delete(depth);
  if(!compare_arrays_i(array1d_itime_idepthphy_max2,
                       array1d_itime_idepthphy_max_ref2,
                       NTIMES)){
    printf("PASS\n\n");
  }else{
    printf("FAIL\n\n");
  }
  
  /////////// Return. ///////////
  return 0;
}
